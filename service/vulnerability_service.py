from service.input_service import execute_command
from service.log_service import log_warn

def search_sensitive_log(data):   
    # output = execute_command(["adb", "logcat", "-d", "|", "grep", f"{data}", "|", "tail", "-n", "8"])
    output = execute_command(["adb", "logcat", "-d", "|", "tail", "-n", "4"])

    if output:
        print(f"[+] Sensitive data '{data}' were found in logs")
        log_warn(output)
        # @todo output ta muito grande, encurtar isso
        # @todo add this on the temp memory using objects to build the report later

        #adb logcat -d | tail -n 4